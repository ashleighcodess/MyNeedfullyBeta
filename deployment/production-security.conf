# MyNeedfully Production Security Configuration for Contabo VPS
# Place this in: /etc/myneedfully/security.conf

# Authentication Security Settings
SESSION_TIMEOUT=1800  # 30 minutes for admin sessions
USER_SESSION_TIMEOUT=604800  # 1 week for regular users
MAX_LOGIN_ATTEMPTS=5
LOGIN_LOCKOUT_DURATION=900  # 15 minutes
WEBSOCKET_AUTH_REQUIRED=true

# Rate Limiting (Per Hour)
GENERAL_RATE_LIMIT=100
AUTH_RATE_LIMIT=5
SEARCH_RATE_LIMIT=60
CREATE_USER_RATE_LIMIT=3
UPLOAD_RATE_LIMIT=10

# Security Monitoring
SECURITY_ALERTS_ENABLED=true
THREAT_DETECTION_ENABLED=true
IP_BLOCKING_ENABLED=true
SUSPICIOUS_ACTIVITY_THRESHOLD=5
AUTO_BLOCK_CRITICAL_THREATS=true

# Database Security
DB_SSL_REQUIRED=true
DB_CONNECTION_TIMEOUT=30000
DB_POOL_SIZE=20
DB_BACKUP_ENCRYPTION=true

# API Security
API_KEY_ROTATION_DAYS=90
SERPAPI_RATE_LIMIT=30
RAINFOREST_RATE_LIMIT=20
EXTERNAL_API_TIMEOUT=8000

# File Upload Security
MAX_FILE_SIZE=25MB
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,webp
VIRUS_SCANNING_ENABLED=false  # Set to true if ClamAV installed
FILE_QUARANTINE_ENABLED=true

# Headers and CORS Security
CORS_ORIGIN=https://myneedfully.com,https://www.myneedfully.com
CSP_ENABLED=true
HSTS_ENABLED=true
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff

# Logging and Monitoring
SECURITY_LOG_LEVEL=INFO
ACCESS_LOG_ENABLED=true
ERROR_LOG_ENABLED=true
PERFORMANCE_MONITORING=true
REAL_TIME_ALERTS=true

# Production Environment
NODE_ENV=production
CLUSTER_MODE=true
WORKER_PROCESSES=auto  # Will use CPU count
MEMORY_LIMIT=1GB
CPU_LIMIT=80%

# SSL/TLS Configuration
SSL_CERT_PATH=/etc/letsencrypt/live/myneedfully.com/fullchain.pem
SSL_KEY_PATH=/etc/letsencrypt/live/myneedfully.com/privkey.pem
TLS_VERSION=1.2,1.3
CIPHER_SUITE=ECDHE+AESGCM:ECDHE+CHACHA20:DHE+AESGCM:DHE+CHACHA20:!aNULL:!MD5:!DSS

# Backup and Recovery
AUTO_BACKUP_ENABLED=true
BACKUP_FREQUENCY=daily
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=true
BACKUP_ENCRYPTION_KEY_PATH=/etc/myneedfully/backup.key

# System Monitoring
DISK_USAGE_ALERT_THRESHOLD=85%
MEMORY_USAGE_ALERT_THRESHOLD=80%
CPU_USAGE_ALERT_THRESHOLD=75%
LOAD_AVERAGE_THRESHOLD=2.0
NETWORK_MONITORING=true

# Emergency Settings
MAINTENANCE_MODE=false
EMERGENCY_CONTACT=admin@myneedfully.com
INCIDENT_RESPONSE_ENABLED=true
SECURITY_INCIDENT_WEBHOOK=https://alerts.myneedfully.com/security